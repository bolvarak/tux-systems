///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
'use strict'; /// Strict Syntax //////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
import * as fs from 'fs'; /// File-System Module /////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
import * as lodash from 'lodash'; /// Lodash Utility Module //////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
import * as util from 'util'; /// Utility Module /////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
import {v4 as uuidv4} from 'uuid'; /// UUIDv4 Module /////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
export default class { /// CommonUtility Class Definition ////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	/// Properties ///////////////////////////////////////////////////////////////////////////////////////////////////
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	/**
	 * This property contains a reference the the Lodash utility module
	 * @name CommonUtility.lodash
	 * @public
	 * @static
	 * @type {lodash}
	 */
	public static lodash = lodash;

	/**
	 * This property contains a reference to the utility module
	 * @name CommonUtility.util
	 * @public
	 * @static
	 * @type {util}
	 */
	public static util = util;

	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	/// Filesystem-Promises //////////////////////////////////////////////////////////////////////////////////////////
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	/**
	 * This method provides a Promise wrapper for fs.readFile()
	 * @name CommonUtility.fsReadFile()
	 * @param {fs.PathLike} $path
	 * @param {string | {encoding?: string | null | undefined, flag?: string | undefined}, optional} $options
	 * @public
	 * @returns {Promise<string | Buffer>}
	 * @static
	 */
	public static fsReadFile(
		$path: string,
		$options?: string | {encoding?: string | null | undefined, flag?: string | undefined} | null | undefined
	): Promise<string | Buffer> {
		// Return our new Promise
		return new Promise<string | Buffer>(($resolve, $reject): void => {
			// Read the file
			fs.readFile($path, $options, ($error: NodeJS.ErrnoException, $data: string | Buffer): void => {
				// Check for an error
				if ($error) {
					// We're done, reject the promise
					return $reject($error);
				}
				// We're done, resolve the promise
				return $resolve($data);
			});
		});
	}

	/**
	 * This method provides a Promise wrapper for fs.stat()
	 * @name CommonUtility.fsStat()
	 * @param {fs.PathLike} $path
	 * @public
	 * @returns {Promise<fs.Stats>}
	 * @static
	 */
	public static fsStat($path: fs.PathLike): Promise<fs.Stats> {
		// Return our new Promise
		return new Promise<fs.Stats>(($resolve, $reject): void => {
			// Stat the path
			fs.stat($path, ($error: NodeJS.ErrnoException, $stats: fs.Stats): void => {
				// Check for an error
				if ($error) {
					// We're done, reject the promise
					return $reject($error);
				}
				// We're done, resolve the promise
				return $resolve($stats);
			});
		});
	}

	/**
	 * This method provides a Promise wrapper for fs.unlink()
	 * @name CommonUtility.fsUnlink()
	 * @param {fs.PathLike} $path
	 * @public
	 * @returns {Promise<void>}
	 * @static
	 */
	public static fsUnlink($path: fs.PathLike): Promise<void> {
		// Return our new Promise
		return new Promise<void>(($resolve, $reject): void => {
			// Delete the file
			fs.unlink($path, ($error: NodeJS.ErrnoException): void => {
				// Check for an error
				if ($error) {
					// We're done, reject the promise
					return $reject($error);
				}
				// We're done, resolve the promise
				return $resolve();
			});
		});
	}

	/**
	 * This method provides a Promise wrapper for fs.writeFile()
	 * @name CommonUtility.fsWriteFile()
	 * @param {fs.PathLike} $path
	 * @param {any} $data
	 * @param {string | {encoding?: string | null, mode?: string | number | undefined, flag?: string | undefined} | null | undefined, optional} $options
	 * @public
	 * @returns {Promise<void>}
	 * @static
	 */
	public static fsWriteFile(
		$path: fs.PathLike,
		$data: any,
		$options?: string | {encoding?: string | null | undefined, mode?: string | number | undefined, flag?: string | undefined}
			| null | undefined
	): Promise<void> {
		// Return our new Promise
		return new Promise<void>(($resolve, $reject): void => {
			// Write the file
			fs.writeFile($path, $data, $options, ($error: NodeJS.ErrnoException): void => {
				// Check for an error
				if ($error) {
					// We're done, reject the promise
					return $reject($error);
				}
				// We're done, resolve the promise
				return $resolve();
			});
		});
	}

	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	/// Utility Methods //////////////////////////////////////////////////////////////////////////////////////////////
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	/**
	 * This method generates and returns a UUIDv4 string
	 * @name CommonUtility.uuid()
	 * @returns {string}
	 * @public
	 * @static
	 * @uses uuidv4()
	 */
	public static uuid(): string {
		// Return the UUID
		return uuidv4();
	}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
} /// End CommonUtility Class Definition /////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
